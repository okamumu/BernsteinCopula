% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em.R
\name{fit.copula}
\alias{fit.copula}
\title{Run EM Algorithm for Bernstein Copula Estimation (R wrapper)}
\usage{
fit.copula(u, v, R_init, prior = NULL, options = list())
}
\arguments{
\item{u}{Numeric vector in [0, 1]. Pseudo-observations for variable X.}

\item{v}{Numeric vector in [0, 1]. Pseudo-observations for variable Y.}

\item{R_init}{Numeric matrix (m × n). Initial Bernstein copula weight matrix.}

\item{prior}{Numeric matrix (m × n). Dirichlet prior for Bernstein copula weight matrix.}

\item{options}{List. Control parameters. See Details.}
}
\value{
A list with elements:
\describe{
  \item{R}{Estimated weight matrix.}
  \item{llf}{Final log-likelihood.}
  \item{converged}{Logical. TRUE if convergence criteria met.}
  \item{iter}{Number of iterations.}
  \item{abserror}{Final absolute error.}
  \item{relerror}{Final relative error.}
}
}
\description{
Wrapper for the C++ EM implementation. Estimates the copula weight matrix \code{R}
given pseudo-observations \code{u}, \code{v}, and an initial matrix \code{R_init}.
}
\details{
The \code{options} list may include:
\itemize{
  \item \code{maxiter}: Maximum number of iterations (default: 1000)
  \item \code{abstol}: Absolute tolerance for log-likelihood (default: 1e-3)
  \item \code{reltol}: Relative tolerance (default: 1e-6)
  \item \code{mstep_maxiter}: Maximum M-step iterations (default: 1000)
  \item \code{mstep_abstol}: M-step tolerance (default: 1e-10)
  \item \code{mstep}: M-step algorithm ("sinkhorn" or "dou") (default: "sinkhorn")
  \item \code{verbose}: Logical. Print progress (default: FALSE)
}
}
\examples{
u <- runif(100)
v <- runif(100)
R0 <- matrix(1/9, 3, 3)
result <- fit.copula(u, v, R0)
result$R
}
