% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em.R
\name{fit.copula.joint}
\alias{fit.copula.joint}
\title{EM Algorithm for Bernstein Copula with Flexible Marginals (via R6)}
\usage{
fit.copula.joint(x, y, R_init, prior = NULL, Fx, Gy, options = list())
}
\arguments{
\item{x}{Numeric vector. Samples for variable X.}

\item{y}{Numeric vector. Samples for variable Y.}

\item{R_init}{Matrix. Initial copula weight matrix of size \eqn{m \times n}.}

\item{prior}{Matrix or `NULL`. Prior weight matrix for tau-bar; defaults to a matrix of ones.}

\item{Fx}{R6 object representing the marginal model for X. Must have fields and methods as described above.}

\item{Gy}{R6 object representing the marginal model for Y. Must have fields and methods as described above.}

\item{options}{List of algorithm options. Must contain:
\describe{
  \item{maxiter}{Maximum number of EM iterations.}
  \item{abstol}{Absolute tolerance for convergence.}
  \item{reltol}{Relative tolerance for convergence.}
  \item{joint.est}{Logical. If `TRUE`, update marginal parameters in the M-step.}
  \item{steps}{Number of steps for progress output.}
  \item{mstep_maxiter}{Maximum number of M-step iterations (for copula update).}
  \item{mstep_abstol}{Tolerance for M-step convergence.}
  \item{mstep}{Character string, either `"dou"` or `"sinkhorn"` to choose M-step method.}
  \item{verbose}{Logical. If `TRUE`, print progress during EM.}
}}
}
\value{
A list containing:
\describe{
  \item{R}{Estimated copula weight matrix.}
  \item{params1}{Final parameters for the X marginal model.}
  \item{params2}{Final parameters for the Y marginal model.}
  \item{llf}{Final log-likelihood value.}
  \item{converged}{Logical. Whether the algorithm converged.}
  \item{iter}{Number of EM iterations completed.}
  \item{abserror}{Final absolute error in log-likelihood.}
  \item{relerror}{Final relative error in log-likelihood.}
}
}
\description{
Runs the EM algorithm to estimate a Bernstein copula and marginal distributions jointly.
Marginals are specified via R6 objects `Fx` and `Gy`, each of which should provide:
- `params`: named list of initial parameters,
- `pdf_func(x, params)`: function to evaluate the marginal density,
- `cdf_func(x, params)`: function to evaluate the marginal CDF,
- `emstep_func(x, w1, w2, params)`: function to update the parameters in the M-step.
}
\examples{
# See vignette or examples for full usage with R6 marginal models.
}
